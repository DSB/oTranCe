<?php
$i = 1;
$export = $this->export;
?>
<h2>Export</h2>
<h4>File status of language packs in VCS:</h4>

<table class="bdr small" summary="List of languages and their change status">
    <tr class="thead">
        <th>#</th>
        <th colspan="3">Language</th>
        <th colspan="2">Latest change</th>
    </tr>
<?php
$languagesToUpdate = 0;
foreach ($this->status as $key => $s)
{
    if ($this->languages[$key]['active'] == 0) {
        continue;
    }
    $tsSvn = $export->convertUnixDate($export->getFileTimestamp($key) +60);
    $tsDb = $this->historyModel->getLatestChange($key);
?>
    <tr class="<?php echo$this->cycle(array('row-even', 'row-odd'))->next();?>">
        <td class="right"><?php echo $i;?>.</td>
        <td>
            <?php echo $this->printFlag($key);?>
        </td>
        <td><?php echo $this->languages[$key]['locale'];?></td>
        <td><?php echo $this->languages[$key]['name'];?></td>
        <td class="right"><?php echo $tsDb;?></td>
        <td>
            <?php
                if ($tsSvn < $tsDb) {
                ?>
                <a href="<?php echo $this->baseUrl()."/export/update/language/".$key;?>" class="Formbutton">
                    <?php echo $this->getIcon('save', 'Update SVN');?> Export to file</a>
                <?php
                }
            ?>
        </td>
    </tr>
<?php
    $i++;
}
?>
</table>
<br />
<a href="<?php echo $this->baseUrl();?>/export/update.all" class="Formbutton">
    <?php echo $this->getIcon('save', 'Update SVN');?> Export all languages
</a><br/>
